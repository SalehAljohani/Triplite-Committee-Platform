@using Microsoft.AspNetCore.Identity
@using Triplite_Committee_Platform.Models
@using Triplite_Committee_Platform.Data

@inject AppDbContext context
@inject SignInManager<UserModel> SignInManager
@inject UserManager<UserModel> UserManager
@{
    var user = await UserManager.GetUserAsync(User);
    var userDept = new DepartmentModel();
    if (user != null)
    {
        userDept = await context.Department.FindAsync(user.DeptNo);
    }
}

@if (SignInManager.IsSignedIn(User) && user != null)
{
    if (userDept != null)
    {
        <p class="my-md-auto mx-md-auto fw-bold text-black me-sm-5">@userDept.DeptName</p>
    }

    <div class="user-area dropdown me-5">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
           aria-expanded="false">
            <i class="fa fa-user me-1 text-dark"></i>
            <span class="text-black fw-bold">@user.Name</span>
        </a>

        <div class="user-menu dropdown-menu text-center border-1 rounded-3">
            <a class="dropdown-item btn" asp-controller="Profile" asp-action="Index">@Localizer["profile"]</a>
            <li><hr class="dropdown-divider"></li>
            <form id="logoutForm" class="text-center form-inline" asp-controller="Login" asp-action="Logout">
                <button id="logout" type="submit" class="nav-link btn btn-link text-dark border-0 w-100">@Localizer["logout"]</button>
            </form>
        </div>
    </div>
}
